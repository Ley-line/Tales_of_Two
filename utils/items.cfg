#textdomain wesnoth-tales_of_two
# Example shown in item_create.cfg

#define TOT_ITEM_STANDARD_EXCLUDE
    side=1,2
    [not]
        id=Leyla,Enor,Venerion,Owen,Gok,Xerasz,MalinGhost
    [/not]
#enddef

#define TOT_ITEM_IS_GEARED
    [effect]
        apply_to=overlay
        add=misc/geared.png
    [/effect]
    [effect]
        apply_to=new_ability
        [abilities]
            {TOT_ABILITIES_GEARED}
        [/abilities]
    [/effect]
#enddef

#define TOT_ITEM_IS_GEARED_ESSENCE
    [effect]
        apply_to=overlay
        add=misc/geared.png
    [/effect]
    [effect]
        apply_to=new_ability
        [abilities]
            {TOT_ABILITIES_GEARED_ESSENCE}
        [/abilities]
    [/effect]
#enddef

#define TOT_ITEM_IS_GEARED_NECK
    [effect]
        apply_to=overlay
        add=misc/magic-burden.png
    [/effect]
    [effect]
        apply_to=new_ability
        [abilities]
            {TOT_ABILITIES_GEARED_NECK}
        [/abilities]
    [/effect]
#enddef

#define STYLE_ITEM COLOUR SIZE TEXT
<span color='{COLOUR}' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef

#define STYLE_ITEM_COMMON SIZE TEXT
<span color='#14D000' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef
#define STYLE_ITEM_RARE SIZE TEXT
<span color='#003FE8' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef
#define STYLE_ITEM_EPIC SIZE TEXT
<span color='#6B009A' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef
#define STYLE_ITEM_LEGENDARY SIZE TEXT
<span color='#FF6D00' size='{SIZE}' font-weight='bold'>{TEXT}</span>#enddef

#define STYLE_ITEM_STATS_DAMAGE TEXT
<span color='#D7A300' size='medium'>Damage increased by {TEXT}</span>#enddef
#define STYLE_ITEM_STATS_ATTACKS TEXT
<span color='#D7A300' size='medium'>Attacks increased by {TEXT}</span>#enddef
#define STYLE_ITEM_STATS_CUSTOM TEXT
<span color='#D7A300' size='medium'>{TEXT}</span>#enddef
#define STYLE_ITEM_SPECIAL TEXT
<span color='#00DDEC' size='medium' font-style='italic'>New weapon special: {TEXT}</span>#enddef
#define STYLE_ITEM_STATS_TYPE TEXT
<span color='#98C1E5' size='medium' font-style='italic'>Type: {TEXT}</span>#enddef
#define STYLE_ITEM_DESCRIPTION COLOUR TEXT
<span color='{COLOUR}' size='medium' font-style='italic'>{TEXT}</span>#enddef

    #####################
  ##   New ability   ##
#####################

#define TOT_ITEM_FAERIE_FIRE X Y ID
    {TOT_ITEM "empowered faerie fire" () "rare" "attacks/empowered_faerie_fire.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
        [not]
            [has_attack]
                name=$item{ID}.name
            [/has_attack]
        [/not]
    ) ("items/book4.png")
    (_"$unit.name finds a book that contains the powers to learn $item{ID}.name, an arcane based spell. Read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) (Enchanted Elvish Book) }
    {STYLE_ITEM_SPECIAL (magical, firststrike)}
    {STYLE_ITEM_STATS_TYPE (arcane)}
{STYLE_ITEM_DESCRIPTION ($item{ID}.tier_colour) ('Best use is to make someone extra weak much more powerful. Easy to learn, even if your attunement to magic is low.')}")
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name learns to cast empowered faerie fire!"
            [effect]
                apply_to=new_attack
                name=$item{ID}.name
                description= {STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }
                icon=$item{ID}.icon
                type=arcane
                range=ranged
                [specials]
                    {WEAPON_SPECIAL_MAGICAL}
                    {WEAPON_SPECIAL_FIRSTSTRIKE}
                [/specials]
                damage=29
                number=2
                start_time=-450
            [/effect]
            [effect]
                apply_to=new_animation
                id=$item{ID}.name
                [attack_anim]
                    [filter_attack]
                        name=$item{ID}.name
                    [/filter_attack]
                    {MISSILE_FRAME_FAERIE_FIRE}
                    {SOUND:HIT_AND_MISS magic-faeriefire.ogg magic-faeriefire-miss.ogg -450}
                [/attack_anim]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

    #####################
  ##      Spears     ##
#####################

#define TOT_ITEM_OLD_WARSPEAR X Y ID
    {TOT_ITEM "old warspear" "spear" "rare" "attacks/spear-blue.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SPEAR_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/spear-blue.png")
    (_"$unit.name finds an $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (9%)}
    {STYLE_ITEM_STATS_ATTACKS (1)}
    {STYLE_ITEM_SPECIAL (marksman)}
    {STYLE_ITEM_STATS_TYPE (pierce)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=pierce
                remove_specials=marksman
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MARKSMAN}
                [/set_specials]
                increase_damage=9%
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_SPEAR_SILVER X Y ID
    {TOT_ITEM "holy lance" "spear" "epic" "attacks/lance_silver.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SPEAR_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/spear-silver.png")
    (_"$unit.name finds an $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (1)}
    {STYLE_ITEM_STATS_ATTACKS (1)}
    {STYLE_ITEM_STATS_TYPE (arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=arcane
                increase_damage=1
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

    #####################
  ##       Bows      ##
#####################

#define TOT_ITEM_CRYSTAL_LONGBOW X Y ID
    {TOT_ITEM "crystal longbow" "bow" "epic" "attacks/crystal_bow.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_BOW_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/bow-longbow-crystal.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (8)}
    {STYLE_ITEM_STATS_ATTACKS (-2)}
    {STYLE_ITEM_SPECIAL (marksman)}
    {STYLE_ITEM_STATS_TYPE (arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=arcane
                remove_specials=marksman
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MARKSMAN}
                [/set_specials]
                increase_damage=8
                increase_attacks=-2
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_CRYSTAL_SHORTBOW X Y ID
    {TOT_ITEM "crystal shortbow" "bow" "epic" "attacks/crystal_bow.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_BOW_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/bow-crystal.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (-30%)}
    {STYLE_ITEM_STATS_ATTACKS (3)}
    {STYLE_ITEM_SPECIAL (marksman)}
    {STYLE_ITEM_STATS_TYPE (arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=arcane
                remove_specials=marksman
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MARKSMAN}
                [/set_specials]
                increase_damage=-30%
                increase_attacks=3
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_LONGBOW_YEW X Y ID
    {TOT_ITEM "yew longbow" "bow" "rare" "attacks/bow-short-reinforced.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_BOW_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/bow-longbow-yew.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (22%)}
    {STYLE_ITEM_SPECIAL (marksman)}
    {STYLE_ITEM_STATS_TYPE (pierce)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=pierce
                remove_specials=marksman,spirited
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MARKSMAN}
                [/set_specials]
                increase_damage=22%
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_SHORTBOW_YEW X Y ID
    {TOT_ITEM "yew shortbow" "bow" "rare" "attacks/shortbow_modern.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_BOW_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/bow-longbow-yew.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (-15%)}
    {STYLE_ITEM_STATS_ATTACKS (2)}
    {STYLE_ITEM_STATS_TYPE (pierce)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=pierce
                increase_damage=-15%
                increase_attacks=2
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_BANEBOW X Y ID
    {TOT_ITEM "bane bow" "bow" "rare" "attacks/bow_undead.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_BOW_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/bow-bane.png")
    (_"$unit.name finds a $item{ID}.name. Apart from the gore, it looks good. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (12%)}
    {STYLE_ITEM_STATS_CUSTOM (Sets your alignment to chaotic)}
    {STYLE_ITEM_STATS_TYPE (pierce)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=pierce
                increase_attacks=12%
            [/effect]
            [effect]
                apply_to=alignment
                set=chaotic
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

    #####################
  ##      Swords     ##
#####################

#define TOT_ITEM_ELVISH_LONGSWORD X Y ID
    {TOT_ITEM "elvish longsword" "sword" "rare" "attacks/sword-elven.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-longsword-elvish.png")
    (_"$unit.name finds an $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (3)}
    {STYLE_ITEM_STATS_ATTACKS (1)}
    {STYLE_ITEM_SPECIAL (marksman)}
    {STYLE_ITEM_STATS_TYPE (blade)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=blade
                remove_specials=marksman
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MARKSMAN}
                [/set_specials]
                increase_damage=3
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_ELVISH_LONGSWORD_ENCHANTED X Y ID
    {TOT_ITEM "enchanted elvish longsword" "sword" "epic" "attacks/sword-elven-enchanted.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-longsword-elvish-glowing.png")
    (_"$unit.name finds an $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (22%)}
    {STYLE_ITEM_STATS_ATTACKS (1)}
    {STYLE_ITEM_SPECIAL (magical)}
    {STYLE_ITEM_STATS_TYPE (arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=arcane
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=22%
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_HUMAN_SHORTSWORD X Y ID
    {TOT_ITEM "handcrafted shortsword" "sword" "rare" "attacks/sword-human.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-shortsword-human.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (-30%)}
    {STYLE_ITEM_STATS_ATTACKS (2)}
    {STYLE_ITEM_STATS_TYPE (pierce)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=pierce
                increase_damage=-30%
                increase_attacks=2
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_HUMAN_LONGSWORD X Y ID
    {TOT_ITEM "handcrafted longsword" "sword" "rare" "attacks/sword-human.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-longsword-human.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (45%)}
    {STYLE_ITEM_STATS_ATTACKS (-25%)}
    {STYLE_ITEM_STATS_TYPE (blade)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=blade
                increase_damage=45%
                increase_attacks=-25%
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_HUMAN_SWORD X Y ID
    {TOT_ITEM "handcrafted sword" "sword" "rare" "attacks/sword-human.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-normal-human.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (18%)}
    {STYLE_ITEM_STATS_TYPE (blade)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=blade
                increase_damage=18%
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_RAPIER_FINE X Y ID
    {TOT_ITEM "fine rapier" "sword" "rare" "attacks/rapier.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-rapier.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (10%)}
    {STYLE_ITEM_STATS_TYPE (pierce)}
    {STYLE_ITEM_SPECIAL (precise)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=pierce
                increase_damage=10%
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_PRECISE}
                [/set_specials]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_RAPIER_POISONED X Y ID
    {TOT_ITEM "poisoned rapier" "sword" "epic" "attacks/rapier-poison.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-rapier-poisoned.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (11%)}
    {STYLE_ITEM_STATS_TYPE (pierce)}
    {STYLE_ITEM_SPECIAL (precise, poison)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=pierce
                increase_damage=11%
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_PRECISE}
                    {WEAPON_SPECIAL_POISON}
                [/set_specials]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_SWORD_EXPERIMENTAL X Y ID
    {TOT_ITEM "experimental weapon" "sword" "epic" "attacks/experimental_sword.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-experimental.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (5%)}
    {STYLE_ITEM_STATS_ATTACKS (2)}
    {STYLE_ITEM_STATS_TYPE (cold)}
    {STYLE_ITEM_SPECIAL (magical)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips $item{ID}.name as it starts humming and glowing.."
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=cold
                increase_damage=5%
                increase_attacks=2
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_SWORD_FLAMING X Y ID
    {TOT_ITEM "flaming sword" "sword" "common" "attacks/sword-flaming.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/flame-sword.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (15%)}
    {STYLE_ITEM_STATS_TYPE (fire)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=fire
                increase_damage=15%
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_SWORD_FLAMING_HEAVY X Y ID
    {TOT_ITEM "heavy flaming sword" "sword" "rare" "attacks/sword-flaming.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-flame-heavy.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (22%)}
    {STYLE_ITEM_STATS_ATTACKS (-1)}
    {STYLE_ITEM_STATS_TYPE (fire)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=fire
                increase_damage=22%
                increase_attacks=-1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_SWORD_FLAMING_UNDYING X Y ID
    {TOT_ITEM "sword of the undying" "sword" "epic" "attacks/flame_sword_purple.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_SWORD_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/sword-flame-heavy-purple.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (26%)}
    {STYLE_ITEM_STATS_ATTACKS (-1)}
    {STYLE_ITEM_SPECIAL (magical)}
    {STYLE_ITEM_STATS_TYPE (fire)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips $item{ID}.name as it starts scorching with purple flames"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=fire
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=26%
                increase_attacks=-1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

    #####################
  ##      Staves     ##
#####################

#define TOT_ITEM_STAFF_BLUE X Y ID
    {TOT_ITEM "blue staff" "staff" "rare" "attacks/staff-elven.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-blue.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (All magical damage increased by 1)}
    {STYLE_ITEM_STATS_CUSTOM (All magical attacks increased by 1)}
    {STYLE_ITEM_SPECIAL (magical)}
    {STYLE_ITEM_STATS_TYPE (cold, for staff only)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                set_type=cold
            [/effect]
            [effect]
                apply_to=attack
                type=fire,cold,arcane
                increase_damage=1
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_TRIDENT_SEA X Y ID
    {TOT_ITEM "trident of the sea" "staff" "epic" "attacks/trident-blue.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-sea-trident.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (All magical attacks increased by 2)}
    {STYLE_ITEM_STATS_CUSTOM (Increased staff damage by 4)}
    {STYLE_ITEM_STATS_CUSTOM (Learn a new attack that makes your trident fly by itself)}
    {STYLE_ITEM_SPECIAL (magical)}
    {STYLE_ITEM_STATS_TYPE (pierce)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                set_type=pierce
                increase_damage=4
            [/effect]
            [effect]
                apply_to=attack
                type=fire,cold,arcane
                increase_attacks=2
            [/effect]
            [effect]
                apply_to=new_attack
                name=$item{ID}.name
                description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                damage=16
                number=1
                range=ranged
                icon=$item{ID}.icon
                [specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                    {TOT_SPECIALS_DISTANT_ATTACK}
                [/specials]
                type=pierce
            [/effect]
            [effect]
                apply_to=new_animation
                id=$item{ID}.name
                [attack_anim]
                    [filter_attack]
                        name=$item{ID}.name
                    [/filter_attack]
                    missile_start_time=-150
                    [missile_frame]
                        sound={SOUND_LIST:THROW}
                        duration=1000
                        image="projectiles/trident-blue-n.png"
                        image_diagonal="projectiles/trident-blue-ne.png"
                    [/missile_frame]
                    start_time=-250

                    {SOUND:HIT spear.ogg 0}
                [/attack_anim]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_STAFF_INFERNAL X Y ID
    {TOT_ITEM "infernal battlestaff" "staff" "epic" "attacks/staff-magic-orange.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-red.png")
    (_"$unit.name finds a $item{ID}.name brimming with fiery power. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Fire damage increased by 80%)}
    {STYLE_ITEM_STATS_CUSTOM (Fire attacks increased by -2)}
    {STYLE_ITEM_STATS_CUSTOM (Staff attacks set to 1)}
    {STYLE_ITEM_SPECIAL (magical, overwhelming)}
    {STYLE_ITEM_STATS_TYPE (fire)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                remove_specials=magical
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=80%
                increase_attacks=-99%
                set_type=fire
            [/effect]
            [effect]
                apply_to=attack
                type=fire
                range=ranged
                increase_damage=80%
                increase_attacks=-2
                remove_specials=overwhelming tot
                set_icon=attacks/fireball3.png
                set_description=infernal bolt
                remove_specials=overwhelming tot
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_OVERWHELMING}
                [/set_specials]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_STAFF_LIFE X Y ID
    {TOT_ITEM "staff of life" "staff" "rare" "attacks/staff-magic-green.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-green.png")
    (_"$unit.name finds a $item{ID}.name with regenerative properties. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Magical damage increased by 10%)}
    {STYLE_ITEM_STATS_CUSTOM (Staff attacks increased by 1)}
    {STYLE_ITEM_STATS_CUSTOM (Learn to heal for +8 and cure nearby allies)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                increase_attacks=1
            [/effect]
            [effect]
                apply_to=attack
                type=fire,arcane,cold
                increase_damage=15%
            [/effect]
            [effect]
                apply_to=remove_ability
                [abilities]
                    {ABILITY_HEALS}
                    {ABILITY_UNPOISON}
                [/abilities]
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_EXTRA_HEAL}
                    {TOT_ABILITIES_REGENERATION_LESSER}
                    {ABILITY_AMBUSH}
                [/abilities]
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_STAFF_ILETYL X Y ID
    {TOT_ITEM "Iletyl-grand staff of the ancients" "staff" "legendary" "attacks/staff-magic-wood.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-wood2.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Magical damage increased by 30%)}
    {STYLE_ITEM_STATS_CUSTOM (Magical attacks increased by 1)}
    {STYLE_ITEM_STATS_CUSTOM (Staff attacks increased by 1)}
    {STYLE_ITEM_STATS_CUSTOM (Sets your alignment to neutral)}
    {STYLE_ITEM_STATS_CUSTOM (Learn: lesser illumination)}
    {STYLE_ITEM_SPECIAL (guided, purify undead)}
    {STYLE_ITEM_STATS_TYPE (arcane, staff only)}
{STYLE_ITEM_DESCRIPTION ($item{ID}.tier_colour) ('Some that live may deserve death, but some that die deserve life.')}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                type=fire,arcane,cold
                remove_specials=magical,precise tot,spirited tot,guided tot,marksman
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_GUIDED}
                [/set_specials]
            [/effect]
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=arcane
            [/effect]
            [effect]
                apply_to=attack
                type=fire,arcane,cold
                increase_damage=30%
                increase_attacks=1
            [/effect]
            [effect]
                apply_to=alignment
                set=neutral
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {TOT_ABILITIES_ILLUMINATES_LESSER}
                [/abilities]
            [/effect]
            [effect]
                apply_to=attack
                range=melee
                remove_specials=purify undead
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_PURIFY_UNDEAD}
                [/set_specials]
            [/effect]
            [effect]
                apply_to=halo
                {HALO_SHIELD_WHITE}
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_STAFF_NECRO X Y ID
    {TOT_ITEM "necrostaff" "staff" "rare" "attacks/staff-necromantic-greater.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-dark.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Magical damage increased by 15%)}
    {STYLE_ITEM_STATS_CUSTOM (Increase melee attacks by 1)}
    {STYLE_ITEM_STATS_CUSTOM (Sets your alignment to chaotic)}
    {STYLE_ITEM_SPECIAL (plague)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                remove_specials=plague
                increase_attacks=1
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_PLAGUE}
                [/set_specials]
            [/effect]
            [effect]
                apply_to=attack
                type=fire,arcane,cold
                increase_damage=15%
            [/effect]
            [effect]
                apply_to=alignment
                set=chaotic
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_STAFF_NECRO_GREATER X Y ID
    {TOT_ITEM "greater necrostaff" "staff" "epic" "attacks/staff-necromantic-greater-2.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_STAFF_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/staff-dark-greater.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Magical damage increased by 20%)}
    {STYLE_ITEM_STATS_CUSTOM (Increase melee attacks by 3)}
    {STYLE_ITEM_STATS_CUSTOM (Increase magical attacks by 1)}
    {STYLE_ITEM_STATS_CUSTOM (Sets your alignment to chaotic)}
    {STYLE_ITEM_SPECIAL (improved plague)}
    {STYLE_ITEM_STATS_TYPE (cold, on staff only)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=cold
                increase_attacks=1
                remove_specials=plague improved,plague
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_PLAGUE_IMPROVED}
                [/set_specials]
            [/effect]
            [effect]
                apply_to=attack
                type=fire,arcane,cold
                increase_damage=20%
                increase_attacks=1
            [/effect]
            [effect]
                apply_to=alignment
                set=chaotic
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

    #####################
  ##     Hammers     ##
#####################

#define TOT_ITEM_HAMMER_HEAVY X Y ID
    {TOT_ITEM "heavy warhammer" "hammer" "common" "attacks/hammer-dwarven.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_HAMMER_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/warhammer-heavy.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (7)}
    {STYLE_ITEM_STATS_TYPE (impact)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=impact
                remove_specials=spirited
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_SPIRITED}
                [/set_specials]
                increase_damage=7
            [/effect]
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

#define TOT_ITEM_HAMMER_LIGHTNING X Y ID
    {TOT_ITEM "Baladûr-hammer of sky" "hammer" "legendary" "attacks/hammer-runic2.png" {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_HAMMER_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/hammer-runic-lightning.png")
    (_"$unit.name finds $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (9)}
    {STYLE_ITEM_STATS_CUSTOM (Learn otherworldly lightning, arcane smash)}
    {STYLE_ITEM_SPECIAL (magical)}
    {STYLE_ITEM_STATS_TYPE (impact, arcane, arcane)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($item{ID}.name) }"
                set_icon=$item{ID}.icon
                set_type=impact
                remove_specials=magical
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_SPIRITED}
                [/set_specials]
                increase_damage=9
            [/effect]

            [effect]
                apply_to=new_attack
                name= $item{ID}.types_apply
                description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) (arcane smash) }"
                icon=$item{ID}.icon
                type=arcane
                range=melee
                [specials]
                    {TOT_SPECIALS_PRECISE}
                [/specials]
                damage=35
                number=1
            [/effect]
            
            [effect]
                apply_to=new_attack
                name="lightning"
                description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) (otherworldly lightning) }"
                icon=attacks/lightning.png
                type=arcane
                range=ranged
                [specials]
                    {WEAPON_SPECIAL_MAGICAL}
                [/specials]
                damage=17
                number=3
            [/effect]
            {LIGHTNING_ANIMATION "lightning" 1}
            {LIGHTNING_ANIMATION "lightning" 2}
            {LIGHTNING_ANIMATION "lightning" 3}
            {TOT_ITEM_IS_GEARED}
        [/object]
    )}
#enddef

    #####################
  ##     Essences    ##
#####################
#define TOT_ITEM_ESSENCE_FLICKERING X Y ID
    {TOT_ITEM "flickering essence" "essence" "common" () {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_ESSENCE_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/essence_flickering.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Damage increased by 20% on melee attacks without the use of a weapon)}
    {STYLE_ITEM_SPECIAL (spirited)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name draws the energy from the $item{ID}.name.."
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                increase_damage=20%
            [/effect]
            {TOT_ITEM_IS_GEARED_ESSENCE}
        [/object]
    )}
#enddef

#define TOT_ITEM_ESSENCE_LOST X Y ID
    {TOT_ITEM "lost essence" "essence" "rare" () {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_ESSENCE_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/essence_lost.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (11%)}
    {STYLE_ITEM_STATS_ATTACKS (1)}
    {STYLE_ITEM_SPECIAL (spirited)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name draws the energy from the $item{ID}.name.."
            [effect]
                apply_to=attack
                range=ranged,melee
                remove_specials=spirited
                [set_specials]
                    mode=append
                    {TOT_SPECIALS_SPIRITED}
                [/set_specials]
                increase_damage=11%
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED_ESSENCE}
        [/object]
    )}
#enddef

#define TOT_ITEM_ESSENCE_INTERTWINED X Y ID
    {TOT_ITEM "magically intertwined essence" "essence" "epic" () {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_ESSENCE_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/essence_intertwined.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_DAMAGE (-15%)}
    {STYLE_ITEM_STATS_ATTACKS (2)}
    {STYLE_ITEM_SPECIAL (magical)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name draws the energy from the $item{ID}.name.."
            [effect]
                apply_to=attack
                range=ranged,melee
                remove_specials=magical,spirited
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=-15%
                increase_attacks=2
            [/effect]
            {TOT_ITEM_IS_GEARED_ESSENCE}
        [/object]
    )}
#enddef

#define TOT_ITEM_ESSENCE_DIVINE X Y ID
    {TOT_ITEM "divine essence" "essence" "legendary" () {ID} {X} {Y} (
        [has_attack]
            name=$item{ID}.types_apply
        [/has_attack]
        {TOT_ITEM_TYPE_ESSENCE_CHECK}
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/essence_divine.png")
    (_"$unit.name finds a $item{ID}.name. Equip it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Damage increased by 25% on melee attacks without the use of a weapon)}
    {STYLE_ITEM_STATS_CUSTOM (Ranged damage increased by 10%)}
    {STYLE_ITEM_STATS_CUSTOM (Heal to full and increase maximum hitpoints by 20)}
    {STYLE_ITEM_STATS_CUSTOM (Learn divine lightning)}
    {STYLE_ITEM_SPECIAL (magical, guided)}")
    _"Equip it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [sound]
            name=magic-holy-alt-1.ogg
        [/sound]
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name draws the energy from the $item{ID}.name.."
            [effect]
                apply_to=attack
                name= $item{ID}.types_apply
                set_description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) ($unit.attack[0].description) }"
                increase_damage=25%
            [/effect]
            [effect]
                apply_to=attack
                range=ranged
                remove_specials=magical,spirited
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
                increase_damage=10%
            [/effect]
            [effect]
                apply_to=hitpoints
                increase_total=20
                heal_full=yes
            [/effect]
            [effect]
                apply_to=new_attack
                name="divine lightning"
                description= "{STYLE_ITEM ($item{ID}.tier_colour) (medium) (divine lightning) }"
                icon=attacks/smite4.png
                type=arcane
                range=ranged
                [specials]
                    {TOT_SPECIALS_GUIDED}
                [/specials]
                damage=38
                number=1
            [/effect]
            [effect]
                apply_to=new_animation
                id=divine lightning
                [attack_anim]
                    [filter_attack]
                        name=divine lightning
                    [/filter_attack]
                    start_time=-395
                    {MISSILE_FRAME_SMITE_BEAM}
                    [frame]
                        sound=magic-holy-alt-1.ogg
                    [/frame]
                    {SOUND:HIT_AND_MISS double_lightning.ogg lightning-miss.ogg -300}
                [/attack_anim]
            [/effect]
            {TOT_ITEM_IS_GEARED_ESSENCE}
        [/object]
    )}
#enddef

    #####################
  ##    Jewellery    ##
#####################

#define TOT_ITEM_AMULET_OF_STRENGTH X Y ID
    {TOT_ITEM "amulet of strength" () "common" "items/amulet_strength.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
        {TOT_ITEM_TYPE_NECKLACE_CHECK}
    ) ("items/amulet_strength.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Melee damage increased by 5)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name and feels a magical burden within.."
            [effect]
                apply_to=attack
                range=melee
                increase_damage=5
            [/effect]
            {TOT_ITEM_IS_GEARED_NECK}
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_BALANCE X Y ID
    {TOT_ITEM "amulet of balance" () "common" "items/amulet_balance.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
        {TOT_ITEM_TYPE_NECKLACE_CHECK}
    ) ("items/amulet_balance.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (All damage increased by 3)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                range=melee
                increase_damage=3
            [/effect]
            [effect]
                apply_to=attack
                range=ranged
                increase_damage=3
            [/effect]
            {TOT_ITEM_IS_GEARED_NECK}
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_HASTE X Y ID
    {TOT_ITEM "amulet of haste" () "common" "items/amulet_haste.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
        {TOT_ITEM_TYPE_NECKLACE_CHECK}
    ) ("items/amulet_haste.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Melee attacks increased by 1)}
    {STYLE_ITEM_STATS_CUSTOM (Ranged pierce attacks increased by 1)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                range=melee
                increase_attacks=1
            [/effect]
            [effect]
                apply_to=attack
                range=ranged
                type=pierce
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED_NECK}
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_MAGIC X Y ID
    {TOT_ITEM "amulet of magic" () "common" "items/amulet_magic.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
        {TOT_ITEM_TYPE_NECKLACE_CHECK}
    ) ("items/amulet_magic.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Magical damage increased by 4%)}
    {STYLE_ITEM_STATS_CUSTOM (Magical attacks increased by 1)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=attack
                type=fire,cold,arcane
                increase_damage=4%
                increase_attacks=1
            [/effect]
            {TOT_ITEM_IS_GEARED_NECK}
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_DEFENCE X Y ID
    {TOT_ITEM "amulet of defence" () "rare" "items/amulet_defence.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
        {TOT_ITEM_TYPE_NECKLACE_CHECK}
    ) ("items/amulet_defence.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Physical resistances increased by 5%)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    blade=-5
                    impact=-5
                    pierce=-5
                [/resistance]
            [/effect]
            {TOT_ITEM_IS_GEARED_NECK}
        [/object]
    )}
#enddef

#define TOT_ITEM_AMULET_OF_ARCANE_FORTITUDE X Y ID
    {TOT_ITEM "amulet of arcane fortitude" () "rare" "items/amulet_fortitude.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
        {TOT_ITEM_TYPE_NECKLACE_CHECK}
    ) ("items/amulet_fortitude.png")
    (_"$unit.name finds an $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Magical resistances increased by 6%)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    fire=-6
                    cold=-6
                    arcane=-6
                [/resistance]
            [/effect]
            {TOT_ITEM_IS_GEARED_NECK}
        [/object]
    )}
#enddef

#define TOT_ITEM_RING_OF_REGENERATION_LESSER X Y ID
    {TOT_ITEM "ring of lesser regeneration" () "common" "items/ring-regen_lesser.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/ring-regen_lesser.png")
    (_"$unit.name finds a $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Learn lesser regeneration)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=new_ability
                [abilities]
                    {TOT_ABILITIES_REGENERATION_LESSER}
                [/abilities]
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_RING_OF_REGENERATION X Y ID
    {TOT_ITEM "ring of regeneration" () "rare" "items/ring-regen_major.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/ring-regen_major.png")
    (_"$unit.name finds a $item{ID}.name, wear it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Learn regenerates)}")
    _"Wear it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name equips the $item{ID}.name"
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_REGENERATES}
                [/abilities]
            [/effect]
        [/object]
    )}
#enddef

    #####################
  ##      Potions    ##
#####################

#define TOT_ITEM_POTION_DARKNESS X Y ID
     {TOT_ITEM "potion of darkness" () "rare" "items/potion-darkness.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-darkness.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Sets alignment to chaotic and learns dark aura)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name drinks the $item{ID}.name"
            [effect]
                apply_to=new_ability
                [abilities]
                    {TOT_ABILITIES_DARK_AURA}
                [/abilities]
            [/effect]
            [effect]
                apply_to=remove_ability
                [abilities]
                    {ABILITY_ILLUMINATES}
                [/abilities]
            [/effect]
            [effect]
                apply_to=halo
                halo=halo/darkens-aura.png
            [/effect]
            [effect]
                apply_to=alignment
                set=chaotic
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_HOLY X Y ID
    {TOT_ITEM "holy water" () "rare" "items/potion-illuminating.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-illuminating.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Sets alignment to lawful and learns illuminates)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name drinks the $item{ID}.name"
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_ILLUMINATES}
                [/abilities]
            [/effect]
            [effect]
                apply_to=remove_ability
                [abilities]
                    {TOT_ABILITIES_DARK_AURA}
                [/abilities]
            [/effect]
            [effect]
                apply_to=halo
                halo=halo/illuminates-aura.png
            [/effect]
            [effect]
                apply_to=alignment
                set=lawful
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_OVERDOSE X Y ID
    {TOT_ITEM "overdose" () "epic" "items/potion-foul-liquid.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-foul-liquid.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Take heavy damage temporarily but increases all stats by a large amount, permanently:)}
    {STYLE_ITEM_STATS_CUSTOM (All damage increased by 25%)}
    {STYLE_ITEM_STATS_CUSTOM (All attacks increased by 15%)}
    {STYLE_ITEM_STATS_CUSTOM (All resistances increased by 5%)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name temporarily collapses, but their eyes blaze with strength.."
            [effect]
                apply_to=hitpoints
                increase=-99%
            [/effect]
            [effect]
                apply_to=attack
                range=melee
                increase_attacks=25%
                increase_damage=15%
            [/effect]
            [effect]
                apply_to=attack
                range=ranged
                increase_attacks=25%
                increase_damage=15%
            [/effect]
            [effect]
                apply_to=resistance
                replace=no
                [resistance]
                    blade=-5
                    impact=-5
                    pierce=-5
                    fire=-5
                    arcane=-5
                    cold=-5
                [/resistance]
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_VITALITY X Y ID
    {TOT_ITEM "potion of vitality" () "common" "items/potion-red.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-red.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Heal to full and increase maximum hitpoints by 8)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name drinks the $item{ID}.name"
            [effect]
                apply_to=hitpoints
                increase_total=8
                heal_full=yes
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_VITALITY_GREATER X Y ID
    {TOT_ITEM "greater potion of vitality" () "epic" "items/potion-red-greater.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-red-greater.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Heal to full and increase maximum hitpoints by 20)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name drinks the $item{ID}.name"
            [effect]
                apply_to=hitpoints
                increase_total=16
                heal_full=yes
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_MANA X Y ID
    {TOT_ITEM "mana potion" () "common" "items/potion-blue.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-blue.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Temporarily increases magical damage done with ranged spells by 5)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=scenario
            description= _ "$unit.name drinks the $item{ID}.name. The effects will last until the end of the scenario."
            [effect]
                apply_to=attack
                type=fire,arcane,cold
                increase_damage=5
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_MANA_GREATER X Y ID
    {TOT_ITEM "greater mana potion" () "epic" "items/potion-blue-greater.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-blue-greater.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Permanently increases magical damage done with ranged spells by 10%)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=scenario
            description= _ "$unit.name drinks the $item{ID}.name. The effects will last forever."
            [effect]
                apply_to=attack
                type=fire,arcane,cold
                increase_damage=10%
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_RAGE X Y ID
    {TOT_ITEM "ultimate rage potion" () "rare" "items/potion-orange.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-orange.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Sets maximum hitpoints to 25)}
    {STYLE_ITEM_STATS_CUSTOM (Melee attack damage increased by 10 permanently)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name drinks the $item{ID}.name and shouts in rage!"
            [effect]
                apply_to=hitpoints
                increase_total=-99%
            [/effect]
            [effect]
                apply_to=hitpoints
                increase_total=24
                heal_full=yes
            [/effect]
            [effect]
                apply_to=attack
                ranged=melee
                increase_damage=10
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_ENERGY X Y ID
    {TOT_ITEM "energy potion" () "common" "items/potion-brown.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-brown.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Increases movement points by 1 permanently)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name drinks the $item{ID}.name"
            [effect]
                apply_to=movement
                increase_total=1
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_EXPERIENCE X Y ID
    {TOT_ITEM "liquid knowledge" () "rare" "items/potion-purple.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-purple.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Increases experience by 15)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name drinks the $item{ID}.name and feels wiser."
            [effect]
                apply_to=experience
                increase=15
            [/effect]
        [/object]
        [store_unit]
            [filter]
                x,y={X},{Y}
            [/filter]
            variable=expPot
        [/store_unit]
        {VARIABLE_OP expPot.experience add 35}
        [unstore_unit]
            variable=expPot
            find_vacant=no
        [/unstore_unit]
    )}
#enddef

#define TOT_ITEM_POTION_EXPERIENCE_GREATER X Y ID
    {TOT_ITEM "greater liquid knowledge" () "epic" "items/potion-purple-greater.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-purple-greater.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Increases experience by 35)}
    {STYLE_ITEM_STATS_CUSTOM (Permanently decrease required experience by 15%)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name drinks the $item{ID}.name and feels an immense surge of wisdom!"
            # [effect]
            #     apply_to=experience
            #     increase=35
            # [/effect]
            [effect]
                apply_to=max_experience
                increase=-15%
            [/effect]
        [/object]
        [store_unit]
            [filter]
                x,y={X},{Y}
            [/filter]
            variable=expPotGreater
        [/store_unit]
        {VARIABLE_OP expPotGreater.experience add 35}
        [unstore_unit]
            variable=expPotGreater
            find_vacant=no
        [/unstore_unit]
    )}
#enddef

#define TOT_ITEM_POTION_POISON X Y ID
    {TOT_ITEM "weapon poison" () "rare" "items/potion-poison.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-poison.png")
    (_"$unit.name finds a $item{ID}.name, apply it to your melee weapons?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Apply poison to your melee weapons)}")
    _"Apply it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name applies the $item{ID}.name"
            [effect]
                apply_to=attack
                range=melee
                remove_specials=poison
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_POISON}
                [/set_specials]
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_POTION_LONG_WINTER X Y ID
    {TOT_ITEM "potion of the long winter" () "epic" "items/potion-of-the-long-winter.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/potion-of-the-long-winter.png")
    (_"$unit.name finds a $item{ID}.name, drink it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Increases cold damage by 3)}
    {STYLE_ITEM_STATS_CUSTOM (Choose to turn all your melee or ranged attacks into cold)}")
    _"Drink it"
    _"Leave it"
    _"$unit.name cannot use this item." (
    [message]
        message= _ "What attack(s) would you like to make cold?"
        speaker=narrator
        [option]
            message= _ "Make my melee attacks cold"
            [command]
                [object]
                    name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
                    image=items/potion-of-the-long-winter.png
                    duration=forever
                    description= _ "$unit.name feels a cold rush with a temporary brain freeze.."
                    [effect]
                        apply_to=hitpoints
                        increase=-25%
                    [/effect]
                    [effect]
                        apply_to=attack
                        range=melee
                        set_type=cold
                        increase_damage=3
                    [/effect]
                [/object]
            [/command]
        [/option]
        [option]
            message= _ "Make my ranged attacks cold"
            [command]
                [object]
                    name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
                    image=items/potion-of-the-long-winter.png
                    duration=forever
                    description= _ "$unit.name feels a cold rush with a temporary brain freeze.."
                    [effect]
                        apply_to=hitpoints
                        increase=-25%
                    [/effect]
                    [effect]
                        apply_to=attack
                        range=ranged
                        set_type=cold
                        increase_damage=5
                    [/effect]
                [/object]
            [/command]
        [/option]
        [option]
            message= _ "Quickly spit out the liquid (discard and lose the item)"
        [/option]
    [/message]
    )}
#enddef

    #####################
  ##  Tomes & Books  ##
#####################

#define TOT_ITEM_BOOK_ARCANE X Y ID
    {TOT_ITEM "tome of arcane knowledge" () "epic" "items/enchanted-book-cyan.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/enchanted-book-cyan.png")
    (_"$unit.name finds a $item{ID}.name, read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Arcane damage increased by 35%)}
    {STYLE_ITEM_STATS_CUSTOM (Learn to heal for +8 and cure nearby allies)}
{STYLE_ITEM_DESCRIPTION ($item{ID}.tier_colour) ('Any sufficiently arcane magic is indistinguishable from technology.')}
" )
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [sound]
            name=magic-holy-1.ogg
        [/sound]
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name carefully reads the tome as it disappears with a flash of light, and somehow feels wiser."
            [effect]
                apply_to=attack
                type=arcane
                increase_damage=35%
            [/effect]
            [effect]
                apply_to=remove_ability
                [abilities]
                    {ABILITY_HEALS}
                    {ABILITY_UNPOISON}
                [/abilities]
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_EXTRA_HEAL}
                [/abilities]
            [/effect]
        [/object]
    )}
#enddef

#define TOT_ITEM_BOOK_COLD X Y ID
    {TOT_ITEM "tome of frost and death" () "epic" "items/enchanted-book-death.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/enchanted-book-death.png")
    (_"$unit.name finds a $item{ID}.name, read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Cold damage increased by 35%)}
    {STYLE_ITEM_STATS_CUSTOM (Grants immunity to drain attacks)}
    {STYLE_ITEM_SPECIAL (drains, on cold attacks)}
{STYLE_ITEM_DESCRIPTION ($item{ID}.tier_colour) ('Necromancy, in many ways, is just confirming ancient truths... but those truths can be horrifying.')}

" )
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [sound]
            name=magic-dark-big.ogg
        [/sound]
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name carefully reads the tome as it falls into the void.. Something has changed.."
            [effect]
                apply_to=attack
                type=cold
                remove_specials=drains
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_DRAIN}
                [/set_specials]
                increase_damage=35%
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {TOT_ABILITIES_DEATH_PACT}
                [/abilities]
            [/effect]
        [/object]
        [modify_unit]
            [filter]
                x,y={X},{Y}
            [/filter]
            [status]
                undrainable=yes
                unplagueable=yes
            [/status]
        [/modify_unit]
    )}
#enddef

#define TOT_ITEM_BOOK_FIRE X Y ID
    {TOT_ITEM "tome of the phoenix" () "epic" "items/enchanted-book-orange.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/enchanted-book-orange.png")
    (_"$unit.name finds a $item{ID}.name, read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (Fire damage increased by 35%)}
    {STYLE_ITEM_STATS_CUSTOM (Grants immunity to poison)}
    {STYLE_ITEM_STATS_CUSTOM (Able to damage all adjacent enemies with fire every turn)}
{STYLE_ITEM_DESCRIPTION ($item{ID}.tier_colour) ('Death is only a doorway. Step through, and you will shed your frail skin and take on a form kissed by fire.')}

" )
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [sound]
            name=flame-big-miss.ogg
        [/sound]
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name carefully reads the tome as it spontaneously combusts and feels reborn."
            [effect]
                apply_to=attack
                type=fire
                increase_damage=35%
            [/effect]
            [effect]
                apply_to=hitpoints
                increase=-35%
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {TOT_ABILITIES_ANTITOXINS}
                    {TOT_ABILITIES_RADIATING_FLAMES}
                [/abilities]
            [/effect]
        [/object]
        [modify_unit]
            [filter]
                x,y={X},{Y}
            [/filter]
            [status]
                unpoisonable=yes
            [/status]
        [/modify_unit]
    )}
#enddef

#define TOT_ITEM_BOOK_SILOREI X Y ID
    {TOT_ITEM "sil'orei - resolve of the fallen" () "legendary" "items/enchanted-book-holy.png" {ID} {X} {Y} (
        {TOT_ITEM_STANDARD_EXCLUDE}
    ) ("items/enchanted-book-holy.png")
    (_"$unit.name finds $item{ID}.name, read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
    {STYLE_ITEM_STATS_CUSTOM (All damage increased by 10%)}
    {STYLE_ITEM_STATS_CUSTOM (increase maximum hitpoints by 25%)}
    {STYLE_ITEM_STATS_CUSTOM (Learn to inspire adjacent allies, making them deal 20% increased damage)}
    {STYLE_ITEM_STATS_CUSTOM (Sets alignment to lawful and learns illuminates)}
    {STYLE_ITEM_SPECIAL (magical)}
{STYLE_ITEM_DESCRIPTION ($item{ID}.tier_colour) ('Some dreams are simply not possible, but sometimes the unimagined, is.')}

" )
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [sound]
            name=double_lightning.ogg
        [/sound]
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "The symbols on the tome glow bright white as a bright lightning bolt strikes $unit.name with a bang, before the book disappears.. "
            [effect]
                apply_to=attack
                range=ranged,melee
                increase_damage=10%
                [set_specials]
                    mode=append
                    {WEAPON_SPECIAL_MAGICAL}
                [/set_specials]
            [/effect]
            [effect]
                apply_to=hitpoints
                increase_total=25%
                heal_full=yes
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {ABILITY_ILLUMINATES}
                    {TOT_ABILITIES_INSPIRING 20}
                [/abilities]
            [/effect]
            [effect]
                apply_to=remove_ability
                [abilities]
                    {TOT_ABILITIES_DARK_AURA}
                [/abilities]
            [/effect]
            [effect]
                apply_to=halo
                halo=halo/illuminates-aura.png
            [/effect]
            [effect]
                apply_to=alignment
                set=lawful
            [/effect]
        [/object]
        [modify_unit]
            [filter]
                x,y={X},{Y}
            [/filter]
            [status]
                unpoisonable=yes
            [/status]
        [/modify_unit]
    )}
#enddef

#define TOT_ITEM_BOOK_DEBUG X Y ID
    {TOT_ITEM "hotfix special scout" () "epic" "items/enchanted-book-cyan.png" {ID} {X} {Y} (
    ) ("items/enchanted-book-cyan.png")
    (_"$unit.name finds a $item{ID}.name, read it?
    
    {STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }
" )
    _"Read it"
    _"Leave it"
    _"$unit.name cannot use this item." (
        [sound]
            name=magic-holy-1.ogg
        [/sound]
        [object]
            name= _ "{STYLE_ITEM ($item{ID}.tier_colour) (large) ($item{ID}.name) }"
            image=$item{ID}.icon
            duration=forever
            description= _ "$unit.name carefully reads the tome as it disappears with a flash of light and somehow feels wiser."
            [effect]
                apply_to=attack
                increase_damage=15%
            [/effect]
            [effect]
                apply_to=new_ability
                [abilities]
                    {TOT_ABILITIES_ENDURANCE}
                    {TOT_ABILITIES_SCOUT}
                [/abilities]
            [/effect]
            [effect]
                apply_to=movement
                increase=2
            [/effect]
            [effect]
                apply_to=max_attacks
                increase=1
            [/effect]
        [/object]
    )}
#enddef

    #####################
  ##       Misc      ##
#####################

#define TOT_ITEM_GOLD X Y AMOUNT
    [item]
        x,y={X},{Y}
        image=items/gold-coins-small.png
    [/item]

    [event]
        name=moveto
        [filter]
            x,y={X},{Y}
            side=1,2
        [/filter]
        {TOT_GOLD {AMOUNT}}
        [remove_item]
            x,y={X},{Y}
        [/remove_item]
    [/event]
#enddef

#define TOT_ITEM_GOLD_CHEST X Y AMOUNT
    [item]
        x,y={X},{Y}
        image=items/chest.png
    [/item]

    [event]
        name=moveto
        [filter]
            x,y={X},{Y}
            side=1,2
        [/filter]
        {TOT_GOLD {AMOUNT}}
        [remove_item]
            x,y={X},{Y}
        [/remove_item]
        [item]
            x,y={X},{Y}
            image=items/chest-open.png
        [/item]
    [/event]
#enddef

#define TOT_ITEM_TATTERED_MAP X Y
    [item]
        x,y={X},{Y}
        image=items/tattered-map.png
    [/item]

    [event]
        name=moveto
        [filter]
            x,y={X},{Y}
            side=1,2
        [/filter]
        [remove_item]
            x,y={X},{Y}
        [/remove_item]

        [fire_event]
            name=found map
            [primary_unit]
                id=$unit.id
            [/primary_unit]
        [/fire_event]
    [/event]
#enddef

#define TOT_ITEM_GOLD_MINECART_NW X Y AMOUNT
    [item]
        x,y={X},{Y}
        image=scenery/mine-cart-gold-se-nw.png
    [/item]

    [event]
        name=moveto
        [filter]
            x,y={X},{Y}
            side=1,2
        [/filter]
        {SAY unit "This minecart contains gold!"}
        {TOT_GOLD {AMOUNT}}
        [remove_item]
            x,y={X},{Y}
        [/remove_item]
        [item]
            x,y={X},{Y}
            image=scenery/mine-cart-empty-se-nw.png
        [/item]
    [/event]
#enddef

#define TOT_ITEM_GOLD_MINECART_NE X Y AMOUNT
    [item]
        x,y={X},{Y}
        image=scenery/mine-cart-gold-ne-sw.png
    [/item]

    [event]
        name=moveto
        [filter]
            x,y={X},{Y}
            side=1,2
        [/filter]
        {SAY unit "This minecart contains gold!"}
        {TOT_GOLD {AMOUNT}}
        [remove_item]
            x,y={X},{Y}
        [/remove_item]
        [item]
            x,y={X},{Y}
            image=scenery/mine-cart-empty-ne-sw.png
        [/item]
    [/event]
#enddef